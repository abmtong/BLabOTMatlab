function [DwellTime StepSize]=Generate_DwellTimeHistogram()% Load a Results file with StepSize and DwellTime data from StepFinding and% generate the DwellTime histogram.%% USE: Results=Generate_DwellTimeHistogram()%% Gheorghe Chistol, 25 Jan 2011%% Ask for the ParametersPrompt = {'Dwell Time Histogram Bin Size (sec)'};Title = 'Enter the Following Parameters';Lines = 1;Default = {'0.02'};Options.Resize='on'; Options.WindowStyle='normal'; Options.Interpreter='tex';Answer = inputdlg(Prompt, Title, Lines, Default, Options);%Hist parameters refer to the histogram display at the endDwellTimeBinSize = str2num(Answer{1});%MinCapsidFilling = str2num(Answer{2});%MaxCapsidFilling = str2num(Answer{3});%FillingBinSize   = str2num(Answer{4}); %the length of packaged DNA%% Global Variables and select the folder where Step/Dwell Data is storedglobal analysisPath;if isempty(analysisPath)   disp('analysisPath not defined. Use "SetAnalysisPath" to define it');   return;end%DataPath = uigetdir(analysisPath,'Please Select the Folder where Step Data is Stored'); [DataFile DataPath] = uigetfile([ [analysisPath '\'] '*.mat'], 'Please select a Results file','MultiSelect', 'off');DwellTime = [];StepSize  = [];load([DataPath '\' DataFile]); %data is stored in the data structure FinalDwellsdisp(['Loaded File ' DataFile]);%FinalDwells{FileIndex}{FeedbackCycleIndex}for FileIndex=1:length(FinalDwells)   for FeedbackCycleIndex=1:length(FinalDwells{FileIndex})       if ~isempty(FinalDwells{FileIndex}{FeedbackCycleIndex}) %make sure it's not empty, sometimes it happens           DwellTime = [DwellTime FinalDwells{FileIndex}{FeedbackCycleIndex}.DwellTime];           StepSize  = [StepSize  FinalDwells{FileIndex}{FeedbackCycleIndex}.StepSize];       end   endendclose all; figure; hold on;HistBins=DwellTimeBinSize/2:DwellTimeBinSize:max(DwellTime)+DwellTimeBinSize;[N X]=hist(DwellTime,HistBins);%plot(X,N,'.b');N=N/sum(N);bar(X,N,1);%[F,Xi]=ksdensity(DwellTime);%plot(Xi,F,'ob');title(['N=' num2str(length(DwellTime)) 'dwells' ]);xlabel('Dwell Time (sec)');ylabel('Probability Density');t=DwellTime;Nmin=(mean(t))^2/(mean(t.^2)-(mean(t))^2);Nmin