function StepFinding_PlotLongPauseCorrelations(Data,CorrData)% Output Data Organization:% CorrData(1) contains data for the 1st ATP concentration% CorrData(2) contains data for the 2nd ATP concentration % CorrData(i) contains data for the ith ATP concentration%% Each structure contains a series of fields, for example:% for a=1:length(ConcListATP)%     CorrData(a).ATP                %     CorrData(a).BinStart           %     CorrData(a).BinEnd             %     CorrData(a).LongDwellLocation  %     CorrData(a).LongDwellTime      %     CorrData(a).NextLongDwellTime  %     CorrData(a).DistanceSeparation %     CorrData(a).TemporalSeparation % end%% USE: StepFinding_PlotLongPauseCorrelations(Data,CorrData)%% Gheorghe Chistol, 01 Nov 2010%% Ask for the Parameters%Hist parameters refer to the histogram display at the endPrompt = {'Spatial Separation Axis Limit (bp)',...          'Spatial Separation Bin Width (bp)',...          'Temporal Separation Axis Limit (sec)',...          'Temporal Separation Bin Width (sec)',...         };     Title = 'Enter the Following Parameters';Lines = 1;Default = {'50','1','50','1'};Options.Resize='on'; Options.WindowStyle='normal'; Options.Interpreter='tex';Answer = inputdlg(Prompt, Title, Lines, Default, Options);DistanceSeparationAxisLimit = str2num(Answer{1});DistanceSeparationBinWidth  = str2num(Answer{2});TemporalSeparationAxisLimit = str2num(Answer{3}); TemporalSeparationBinWidth  = str2num(Answer{4});TemporalSeparation_BinCenters = TemporalSeparationBinWidth/2:TemporalSeparationBinWidth:TemporalSeparationAxisLimit-TemporalSeparationBinWidth/2;DistanceSeparation_BinCenters = DistanceSeparationBinWidth/2:DistanceSeparationBinWidth:DistanceSeparationAxisLimit-DistanceSeparationBinWidth/2;N=length(CorrData); %the # of ATP concentrations available%plot the Dwell Time histogramsScreenSize=get(0,'ScreenSize'); %this is used to set the proper dimensions to the plotsw=ScreenSize(3); %screen width in pixelsh=ScreenSize(4); %screen height in pixels%-------------- Plot Temporal Separation data for b=1:length(CorrData(1).BinStart) %index b refers to bins    CurrentFigureStatus='None';         for a=1:N %for all atp concentrations        if ~isempty(CorrData(a).TemporalSeparation{b})            if strcmp(CurrentFigureStatus,'None')                %no figure has been created yet, create it                figure('Position',[9 9 w/2-15 h-80]);                CurrentFigureStatus='Created'; %change the status, figure was created            end                                           subplot(N,1,a);            hist(CorrData(a).TemporalSeparation{b},TemporalSeparation_BinCenters)            set(gca,'XLim',[0 TemporalSeparationAxisLimit]); %well defined axis limits for consistency            legend([ '[ATP] = ' num2str(CorrData(a).ATP) 'uM']);            legend('boxoff');        end    end        if ~strcmp(CurrentFigureStatus,'None')        subplot(N,1,1);        title(['Packaged DNA = ' num2str(CorrData(a).BinStart(b)) '-' num2str(CorrData(a).BinEnd(b)) 'bp']);        subplot(N,1,N);        xlabel('Temporal Separation of Consecutive Long Dwells (sec)');    endend% ------------ Plot Temporal Separation Data with all Packaged-DNA-bins togetherfigure('Position',[9 9 w/2-15 h-80]);for a=1:N %for all atp concentrations    if ~isempty(Data(a).TemporalSeparation)        subplot(N,1,a);        hist(Data(a).TemporalSeparation,TemporalSeparation_BinCenters)        set(gca,'XLim',[0 TemporalSeparationAxisLimit]); %well defined axis limits for consistency        legend([ '[ATP] = ' num2str(Data(a).ATP) 'uM'])        legend('boxoff');    endendsubplot(N,1,N);xlabel('Temporal Separation of Consecutive Long Dwells (sec)'); % ------------ Plot LongDwellTime vs NextLongDwellTime as a way of correlating% the duration of the current long dwell with that of the following long dwellfigure;%('Position',[9 9 w/2-15 h-80]);hold on;for a=1:N %for all atp concentrations    if ~isempty(Data(a).LongDwellTime)        plot(Data(a).LongDwellTime,Data(a).NextLongDwellTime,'.b')        %set(gca,'XLim',[0 TemporalSeparationAxisLimit]); %well defined axis        %limits for consistency    endendylabel('NextLongDwellTime (sec)');xlabel('CurrentLongDwellTime (sec)');% ------------ Plot TemporalSeparationBetweenLongDwells vs LongDwellTimefigure;%('Position',[9 9 w/2-15 h-80]);hold on;for a=1:N %for all atp concentrations    if ~isempty(Data(a).LongDwellTime)        plot(Data(a).LongDwellTime,Data(a).TemporalSeparation,'.b')        %set(gca,'XLim',[0 TemporalSeparationAxisLimit]); %well defined axis        %limits for consistency    endendylabel('Time Before the Next Long Dwell Starts (sec)');xlabel('Current Long Dwell Time (sec)');%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%-------------- Plot Distance Separation data for b=1:length(CorrData(1).BinStart) %index b refers to bins    CurrentFigureStatus='None';         for a=1:N %for all atp concentrations        if ~isempty(CorrData(a).DistanceSeparation{b})            if strcmp(CurrentFigureStatus,'None')                %no figure has been created yet, create it                figure('Position',[9+w/2 9 w/2-15 h-80]);                CurrentFigureStatus='Created'; %change the status, figure was created            end                           subplot(N,1,a);            hist(CorrData(a).DistanceSeparation{b},DistanceSeparation_BinCenters)            set(gca,'XLim',[0 DistanceSeparationAxisLimit]); %well defined axis limits for consistency            legend([ '[ATP] = ' num2str(CorrData(a).ATP) 'uM']);            legend('boxoff');        end    end        if ~strcmp(CurrentFigureStatus,'None')        subplot(N,1,1);        title(['Packaged DNA = ' num2str(CorrData(a).BinStart(b)) '-' num2str(CorrData(a).BinEnd(b)) 'bp']);        subplot(N,1,N);        xlabel('Distance Separation of Consecutive Long Dwells (bp)');    endend% ------------ Plot Distance Separation Data with all Packaged-DNA-bins togetherfigure('Position',[9+w/2 9 w/2-15 h-80]);for a=1:N %for all atp concentrations    if ~isempty(Data(a).DistanceSeparation)        subplot(N,1,a);        hist(Data(a).DistanceSeparation, DistanceSeparation_BinCenters)        set(gca,'XLim',[0 DistanceSeparationAxisLimit]); %well defined axis limits for consistency        legend(['[ATP] = ' num2str(Data(a).ATP) 'uM']);        legend('boxoff');    endendsubplot(N,1,N);xlabel('Distance Separation of Consecutive Long Dwells (sec)');