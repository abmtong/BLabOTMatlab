function StepFinding_PlotPropertiesOfLongPauses(Data,LongDwellData)% Data Organization:% LongDwellData(3)% % ans = % %                       ATP: 100%                  BinStart: [17000 17500 18000 18500 19000 19500 20000 20500]%                    BinEnd: [17500 18000 18500 19000 19500 20000 20500 21000]%               PackagedDNA: [1x7 double]%     FrequencyOfLongPauses: [0 12.8844 27.2454 30.7497 101.0069 142.1191 132.4426]%     TimeSpentInLongPauses: [0 28.9347 43.6794 68.7818 319.0470 692.0510 380.3679]%             LongDwellTime: {1x7 cell}%         LongDwellLocation: {1x7 cell}%% USE: StepFinding_PlotPropertiesOfLongPauses(Data,LongDwellData)%% Gheorghe Chistol, 02 Nov 2010%% Ask for the Parameters%Hist parameters refer to the histogram display at the endN=length(LongDwellData); %the # of ATP concentrations availableB=length(LongDwellData(1).BinStart); % the # of bins%plot the Dwell Time histogramsScreenSize=get(0,'ScreenSize'); %this is used to set the proper dimensions to the plotsw=ScreenSize(3); %screen width in pixelsh=ScreenSize(4); %screen height in pixels%figure('Position',[9 9 w/2-15 h-80]); %-------------- Plot Frequency of Long Pauses per kb of DNA packagedfigure('Position',[10 9 359 682]);for a=1:N %for all atp concentrations    subplot(N,1,a);    x = (LongDwellData(a).BinStart+LongDwellData(a).BinEnd)/2/1000; %in kb    y = LongDwellData(a).FrequencyOfLongPauses;    bar(x,y);                    %set(gca,'XLim',[0 TemporalSeparationAxisLimit]); %well defined axis limits for consistency    %legend([ '[ATP] = ' num2str(LongDwellData(a).ATP) 'uM'],'Location','NW');    %legend('boxoff');    axis([18 20 0 50]);    ylabel([ '[ATP]=' num2str(LongDwellData(a).ATP) 'uM']);endsubplot(N,1,N);xlabel('Amt of DNA Packaged (kb)');subplot(N,1,1);title('Frequency of Long Pauses (per kb DNA)');%-------------- Plot Mean Duration of Long Pausesfigure('Position',[300 9 359 682]);for a=1:N %for all atp concentrations    subplot(N,1,a);    x = (LongDwellData(a).BinStart+LongDwellData(a).BinEnd)/2/1000; %in kb    for b=1:length(LongDwellData(a).BinStart)        if ~isempty(LongDwellData(a).LongDwellTime{b})            y(b) = mean(LongDwellData(a).LongDwellTime{b});        else            y(b) =0;        end    end    bar(x,y);                    %set(gca,'XLim',[0 TemporalSeparationAxisLimit]); %well defined axis limits for consistency    %legend([ '[ATP] = ' num2str(LongDwellData(a).ATP) 'uM'],'Location','NW');    %legend('boxoff');    axis([18 20 0 10]);    %set(gca,'XLim',[17 20.5]);    %set(gca,'YLim',[0 7]);    ylabel([ '[ATP]=' num2str(LongDwellData(a).ATP) 'uM']);endsubplot(N,1,N);xlabel('Amt of DNA Packaged (kb)');subplot(N,1,1);title('Mean Duration of Long Pauses (sec)');%figure('Position',[9 9 w/2-15 h-80]);%-------------- Plot Frequency of Long Pauses Ifigure('Position',[600 9 359 682]);for b=3:B-2 %for all Packaged DNA Bins    subplot(B-4,1,b-2);    x=[]; y=[];    clear XTickLabel    for a=1:N; %for all ATP concentrations        x = [x LongDwellData(a).ATP]; %in kb        temp=num2str(LongDwellData(a).ATP);        XTickLabel(a,:) = [temp blanks(4-length(temp))] ;        y = [y LongDwellData(a).FrequencyOfLongPauses(b)];    end    bar(y);                    %set(gca,'XLim',[0 TemporalSeparationAxisLimit]); %well defined axis limits for consistency    %legend([ 'DNA Packaged = ' num2str((LongDwellData(a).BinStart(b)+LongDwellData(a).BinStart(b))/2/1000) 'kb'],'Location','NW');    %legend('boxoff');    %axis([17 21 0 200]);    ylabel([ num2str(LongDwellData(a).BinStart(b)/1000) '-' num2str(LongDwellData(a).BinEnd(b)/1000) 'kb'])    set(gca,'XTickLabel',XTickLabel);    set(gca,'XLim',[0.5 4.5]);    set(gca,'YLim',[0 50]); %make them all have the same vertical axis limitsendsubplot(B-4,1,B-4);xlabel('ATP Concentrations (uM)');subplot(B-4,1,1);title('Frequency of Long Pauses (per kb packaged)');figure('Position',[900 9 359 682]);%-------------- Plot Mean Duration of long pauses for each bin as a function of ATPfor b=3:B-2 %for all Packaged DNA Bins    subplot(B-4,1,b-2);    x=[]; y=[];    clear XTickLabel    for a=1:N; %for all ATP concentrations        x = [x LongDwellData(a).ATP]; %in kb        temp=num2str(LongDwellData(a).ATP);        XTickLabel(a,:) = [temp blanks(4-length(temp))] ;        y = [y mean(LongDwellData(a).LongDwellTime{b})];    end    bar(y);                    %set(gca,'XLim',[0 TemporalSeparationAxisLimit]); %well defined axis limits for consistency    %legend([ 'DNA Packaged = ' num2str((LongDwellData(a).BinStart(b)+LongDwellData(a).BinStart(b))/2/1000) 'kb'],'Location','NW');    %legend('boxoff');    %axis([17 21 0 200]);    ylabel([ num2str(LongDwellData(a).BinStart(b)/1000) '-' num2str(LongDwellData(a).BinEnd(b)/1000) 'kb'])    set(gca,'XTickLabel',XTickLabel);    set(gca,'XLim',[0.5 4.5]);    set(gca,'YLim',[0 10]); %make them all have the same vertical axis limitsendsubplot(B-4,1,B-4);xlabel('ATP Concentrations (uM)');subplot(B-4,1,1);title('Mean Duration of Long Pauses (sec)');