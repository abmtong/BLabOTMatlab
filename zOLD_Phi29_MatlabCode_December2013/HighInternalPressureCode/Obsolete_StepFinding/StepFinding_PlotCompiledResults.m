function StepFinding_PlotCompiledResults(StepData)% Output Data Organization:% StepData(1) contains data for the 1st ATP concentration% StepData(2) contains data for the 2nd ATP concentration % StepData(i) contains data for the ith ATP concentration%% Each structure contains a series of fields, for example:% StepData(3) =%%           ATP: 200%      BinStart: [1x12 double]%        BinEnd: [1x12 double]%     DwellTime: {1x12 cell}% DwellLocation: {1x12 cell}%      StepSize: {1x12 cell}%  StepLocation: {1x12 cell}%% You can see that StepData(3) corresponds to [ATP]=200uM. BinStart and BinEnd% define where the bin starts/end in bp of DNA packaged (19.3kb corresponds to% Phi29 100% genomic DNA packaged). In this case the data was binned in 12 bins.% You can access the list of step sizes for the 5th bin by referencing:% StepData(3).StepSize{5}%% USE: StepFinding_PlotCompiledResults(StepData)%% Gheorghe Chistol, 28 Oct 2010%% Ask for the Parameters%Hist parameters refer to the histogram display at the endPrompt = {'Step-Size Histogram: Start (bp)',...          'Step-Size Histogram: Finish (bp)',...          'Step-Size Histogram: BinWidth (bp)',...          'Dwell-Time Histogram: Finish (sec)',...          'Dwell-Time Histogram: BinWidth (sec)',...         };     Title = 'Enter the Following Parameters';Lines = 1;Default = {'-15','15','0.5','5','0.1'};Options.Resize='on'; Options.WindowStyle='normal'; Options.Interpreter='tex';Answer = inputdlg(Prompt, Title, Lines, Default, Options);StepSizeHist_Start      = str2num(Answer{1});StepSizeHist_Stop       = str2num(Answer{2}); %in bpStepSizeHist_BinWidth   = str2num(Answer{3}); %in bpDwellTimeHist_Stop      = str2num(Answer{4}); %in secDwellTimeHist_BinWidth  = str2num(Answer{5}); %in secDwellTimeHist_BinCenters = DwellTimeHist_BinWidth/2:DwellTimeHist_BinWidth:DwellTimeHist_Stop;StepSizeHist_BinCenters = StepSizeHist_Start:StepSizeHist_BinWidth:StepSizeHist_Stop;N=length(StepData); %the # of ATP concentrations available%plot the Dwell Time histogramsScreenSize=get(0,'ScreenSize'); %this is used to set the proper dimensions to the plotsw=ScreenSize(3); %screen width in pixelsh=ScreenSize(4); %screen height in pixels%-------------- Plot the Dwell times for b=1:length(StepData(1).BinStart) %index b refers to bins    CurrentFigureStatus='None';         for a=1:N %for all atp concentrations        if ~isempty(StepData(a).DwellTime{b})            if strcmp(CurrentFigureStatus,'None')                %no figure has been created yet, create it                %figure('Position',[9 9 w/2-15 h-80]);                figure('Position',[10 10 450 680]);                CurrentFigureStatus='Created'; %change the status, figure was created            end                           subplot(N,1,a);                        [Count,Bins]=hist(StepData(a).DwellTime{b},DwellTimeHist_BinCenters);            Count=Count/sum(Count); %normalize the count value, Sum(Count)=1;            Count(1)=[]; Count(end)=[]; %don't show the first and the last bins            Bins(1)=[]; Bins(end)=[];            %semilogy(Bins,Count,'.b');            bar(Bins,Count,1);            set(gca,'XLim',[0 DwellTimeHist_Stop]); %well defined axis limits for consistency            ylabel([ '[ATP] = ' num2str(StepData(a).ATP) 'uM'])            set(gca,'YLim',[0 0.4]);        end    end        if ~strcmp(CurrentFigureStatus,'None')        subplot(N,1,1);        title(['Normalized Dwell Time Histogram: ' num2str(StepData(a).BinStart(b)/1000) '-' num2str(StepData(a).BinEnd(b)/1000) 'kb Packaged']);        subplot(N,1,N);        xlabel('Dwell Time (sec)');    endend%-------------- Plot the Step Sizes for b=1:length(StepData(1).BinStart) %index b refers to bins    CurrentFigureStatus='None';         for a=1:N %for all atp concentrations        if ~isempty(StepData(a).StepSize{b})            if strcmp(CurrentFigureStatus,'None')                %no figure has been created yet, create it                %figure('Position',[9+w/2 9 w/2-15 h-80]);                figure('Position',[480 10 450 680]);                CurrentFigureStatus='Created'; %change the status, figure was created            end                                           subplot(N,1,a);            [Count,Bins]=hist(-StepData(a).StepSize{b},StepSizeHist_BinCenters);            Count=Count/sum(Count); %normalize the count value, Sum(Count)=1;            bar(Bins,Count,1);            set(gca,'XLim',[StepSizeHist_Start StepSizeHist_Stop]); %well defined axis limits for consistency            set(gca,'YLim',[0 0.16])            ylabel([ '[ATP] = ' num2str(StepData(a).ATP) 'uM'])        end    end        if ~strcmp(CurrentFigureStatus,'None')        subplot(N,1,1);        title(['Step Size Histogram: ' num2str(StepData(a).BinStart(b)/1000) '-' num2str(StepData(a).BinEnd(b)/1000) 'kb Packaged']);        subplot(N,1,N);        xlabel('Step Size (bp)');    endend